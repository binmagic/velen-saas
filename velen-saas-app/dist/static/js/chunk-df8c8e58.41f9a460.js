(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-df8c8e58"],{"333d":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},o=[];a("c5f6");Math.easeInOutQuad=function(t,e,a,s){return t/=s/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,a){var s=r(),o=t-s,l=20,p=0;e="undefined"===typeof e?500:e;var c=function t(){p+=l;var r=Math.easeInOutQuad(p,s,o,e);n(r),p<e?i(t):a&&"function"===typeof a&&a()};c()}var p={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&l(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},c=p,u=(a("8867"),a("2877")),m=Object(u["a"])(c,s,o,!1,null,"21e4342e",null);e["a"]=m.exports},"5f63":function(t,e,a){"use strict";var s=a("cf4a"),o=a.n(s);o.a},8867:function(t,e,a){"use strict";var s=a("c0c5"),o=a.n(s);o.a},ad28:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("custom-header",{attrs:{"show-name":t.$route.meta.title}}),t._v(" "),a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("调度规则设置")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleDialog()}}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"more-card-body"},[a("el-table",{attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"平台",prop:"platform"}}),t._v(" "),a("el-table-column",{attrs:{label:"process",prop:"process"}}),t._v(" "),a("el-table-column",{attrs:{label:"业务名",prop:"businessName"}}),t._v(" "),a("el-table-column",{attrs:{label:"DSL",prop:"dsl"}}),t._v(" "),a("el-table-column",{attrs:{label:"配置","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return t._l(s.properties,(function(e,s){return a("span",[t._v(t._s(s)+" : "+t._s(e)+";")])}))}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.handleDialogUpdate(s)}}})]}}])})],1)],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.query.page,limit:t.query.limit},on:{"update:page":function(e){return t.$set(t.query,"page",e)},"update:limit":function(e){return t.$set(t.query,"limit",e)},pagination:t.findData}})],1),t._v(" "),a("basic-create",{attrs:{dialogVisible:t.dialogVisible},on:{"update:dialogVisible":function(e){t.dialogVisible=e},"update:dialog-visible":function(e){t.dialogVisible=e},"close-dialog":t.handleClose,"on-create-dispatch":t.handleCreate}}),t._v(" "),a("basic-update",{attrs:{"dialog-visible":t.dialogVisibleUpdate,data:t.data},on:{"close-dialog":t.handleCloseUpdate,"on-update-dispatch":t.handleUpdate}})],1)},o=[],i=a("bc5d"),n=a("b775");function r(){return Object(n["a"])({url:"/dispatch/platform",method:"get"})}function l(){return Object(n["a"])({url:"/dispatch/process",method:"get"})}function p(t){return Object(n["a"])({url:"/dispatch",method:"get",query:t})}function c(t){return Object(n["a"])({url:"/dispatch",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/dispatch",method:"put",data:t})}function m(t){return Object(n["a"])({url:"/dispatch/fast",method:"post",data:t})}var f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,"before-close":t.handleClose,center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n    创建\n  ")]),t._v(" "),a("div",{staticStyle:{"overflow-y":"auto","max-height":"400px"}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"平台"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.platform,callback:function(e){t.platform=e},expression:"platform"}},t._l(t.platforms,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"process"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.process,callback:function(e){t.process=e},expression:"process"}},t._l(t.processes,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.fastDispatch}},[t._v("快速dispatch")])],1),t._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"业务名"}},[a("el-input",{attrs:{placeholder:"业务名不可重复"},model:{value:t.formData.businessName,callback:function(e){t.$set(t.formData,"businessName",e)},expression:"formData.businessName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"DSL"}},[a("el-input",{attrs:{placeholder:"调度表达式"},model:{value:t.formData.dsl,callback:function(e){t.$set(t.formData,"dsl",e)},expression:"formData.dsl"}})],1)],1)],1),t._v(" "),a("el-form",{attrs:{"label-position":"top"}},t._l(t.formData.properties,(function(e,s){return a("el-form-item",{attrs:{label:0==s?"properties":""}},[a("el-row",[a("el-col",{staticStyle:{"margin-right":"20px"},attrs:{span:8}},[a("el-input",{attrs:{placeholder:"名字",size:"small"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"prop.name"}})],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{size:"small"},model:{value:e.prop,callback:function(a){t.$set(e,"prop",a)},expression:"prop.prop"}})],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:1}},[1!=t.formData.properties.length?a("i",{staticClass:"el-icon-remove-outline",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:function(a){return t.delRow(e)}}}):t._e()]),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:1}},[s==t.formData.properties.length-1?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:t.addRow}}):t._e()])],1)],1)})),1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)])},d=[],h=(a("7f7f"),{name:"basic-create",props:{dialogVisible:{type:Boolean,required:!0}},data:function(){return{platforms:[],processes:[],platform:{},process:{},formData:{businessName:"",dsl:"",properties:[{name:"",prop:""}]}}},created:function(){this.findPlatform(),this.findProcess()},methods:{findPlatform:function(){var t=this;r().then((function(e){t.platforms=e}))},findProcess:function(){var t=this;l().then((function(e){t.processes=e}))},handleClose:function(){this.platform={},this.process={},this.formData={businessName:"",dsl:"",properties:[{name:"",prop:""}]},this.$emit("close-dialog")},handleSubmit:function(){var t=this,e={};this.formData.properties.some((function(t){""!=t.name&&(e[t.name]=t.prop)}));var a={platform:this.platform.name,platformType:this.platform.key,process:this.process.name,processType:this.process.key,businessName:this.formData.businessName,dsl:this.formData.dsl,properties:e};c(a).then((function(e){console.log(e),t.$emit("on-create-dispatch"),t.$emit("close-dialog")}))},addRow:function(){this.formData.properties.push({name:"",prop:""})},delRow:function(t){var e=this.formData.properties.indexOf(t);-1!==e&&this.formData.properties.splice(e,1)},fastDispatch:function(){var t=this,e={};this.formData.properties.some((function(t){""!=t.name&&(e[t.name]=t.prop)}));var a={platform:this.platform.name,platformType:this.platform.key,process:this.process.name,processType:this.process.key,businessName:this.formData.businessName,dsl:this.formData.dsl,properties:e};m(a).then((function(e){t.$notify({title:"成功",message:"快速调用",type:"success"})})).catch((function(e){t.$notify({title:"失败",message:e.message,type:"error"})}))}}}),b=h,v=a("2877"),g=Object(v["a"])(b,f,d,!1,null,"cab1deee",null),y=g.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,"before-close":t.handleClose,center:""},on:{"update:visible":function(e){t.dialogVisible=e},open:t.openDialog}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n    "+t._s(t.title)+"\n  ")]),t._v(" "),a("div",{staticStyle:{"overflow-y":"auto","max-height":"400px"}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"平台"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.platform,callback:function(e){t.platform=e},expression:"platform"}},t._l(t.platforms,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"process"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.process,callback:function(e){t.process=e},expression:"process"}},t._l(t.processes,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.fastDispatch}},[t._v("快速dispatch")])],1),t._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"业务名"}},[a("el-input",{attrs:{placeholder:"业务名不可重复"},model:{value:t.formData.businessName,callback:function(e){t.$set(t.formData,"businessName",e)},expression:"formData.businessName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"DSL"}},[a("el-input",{attrs:{placeholder:"调度表达式"},model:{value:t.formData.dsl,callback:function(e){t.$set(t.formData,"dsl",e)},expression:"formData.dsl"}})],1)],1)],1),t._v(" "),a("el-form",{attrs:{"label-position":"top"}},t._l(t.formData.properties,(function(e,s){return a("el-form-item",{attrs:{label:0==s?"properties":""}},[a("el-row",[a("el-col",{staticStyle:{"margin-right":"20px"},attrs:{span:8}},[a("el-input",{attrs:{placeholder:"名字",size:"small"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"prop.name"}})],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{size:"small"},model:{value:e.prop,callback:function(a){t.$set(e,"prop",a)},expression:"prop.prop"}})],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:1}},[1!=t.formData.properties.length?a("i",{staticClass:"el-icon-remove-outline",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:function(a){return t.delRow(e)}}}):t._e()]),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:1}},[s==t.formData.properties.length-1?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{cursor:"pointer","font-size":"18px"},on:{click:t.addRow}}):t._e()])],1)],1)})),1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)])},D=[],k={name:"basic-update",props:{dialogVisible:{type:Boolean,required:!0},title:{type:String},data:{type:Object,default:function(){return{businessName:"",dsl:"",properties:{id:"appId"}}}}},data:function(){return{platforms:[],processes:[],platform:{},process:{},formData:{}}},created:function(){this.findPlatform(),this.findProcess()},methods:{openDialog:function(){this.platform=JSON.parse(JSON.stringify({name:this.data.platform,key:this.data.platformType})),this.process=JSON.parse(JSON.stringify({name:this.data.process,key:this.data.processType})),this.formData=JSON.parse(JSON.stringify(this.data));var t=[];for(var e in this.formData.properties)t.push({name:e,prop:this.formData.properties[e]});this.formData.properties=t.length>0?t:[{name:"",prop:""}]},findPlatform:function(){var t=this;r().then((function(e){t.platforms=e}))},findProcess:function(){var t=this;l().then((function(e){t.processes=e}))},handleClose:function(){this.platform={},this.process={},this.formData={businessName:"",dsl:"",properties:[{name:"",prop:""}]},this.$emit("close-dialog")},handleSubmit:function(){var t=this,e={};this.formData.properties.some((function(t){""!=t.name&&(e[t.name]=t.prop)}));var a={id:this.formData.id,platform:this.platform.name,platformType:this.platform.key,process:this.process.name,processType:this.process.key,businessName:this.formData.businessName,dsl:this.formData.dsl,properties:e};u(a).then((function(e){console.log(e),t.$emit("on-update-dispatch"),t.$emit("close-dialog")}))},addRow:function(){this.formData.properties.push({name:"",prop:""})},delRow:function(t){var e=this.formData.properties.indexOf(t);-1!==e&&this.formData.properties.splice(e,1)},fastDispatch:function(){var t=this,e={};this.formData.properties.some((function(t){""!=t.name&&(e[t.name]=t.prop)}));var a={id:this.formData.id,platform:this.platform.name,platformType:this.platform.key,process:this.process.name,processType:this.process.key,businessName:this.formData.businessName,dsl:this.formData.dsl,properties:e};m(a).then((function(e){t.$emit("on-update-dispatch"),t.$notify({title:"成功",message:"快速调用",type:"success"})})).catch((function(e){t.$notify({title:"失败",message:e.message,type:"error"})}))}}},S=k,w=Object(v["a"])(S,_,D,!1,null,"a59e5c7c",null),x=w.exports,N=a("333d"),$={name:"index",components:{CustomHeader:i["a"],BasicCreate:y,BasicUpdate:x,Pagination:N["a"]},data:function(){return{formData:{},dialogVisible:!1,dialogVisibleUpdate:!1,data:{},dialogData:null,total:0,query:{page:1,limit:10},tableData:[{platform:"1",process:"1",businessName:"1",dsl:"1",properties:{id:"appId",name:"name"}}]}},created:function(){this.findData()},methods:{findData:function(){var t=this;p(this.query).then((function(e){t.total=e.total,t.tableData=e.items}))},handleDialog:function(){this.dialogVisible=!0},handleDialogUpdate:function(t){this.dialogVisibleUpdate=!0,this.data=t},handleClose:function(){this.dialogVisible=!1,this.findData()},handleCloseUpdate:function(){this.dialogVisibleUpdate=!1,this.findData()},handleCreate:function(){this.findData()},handleUpdate:function(){this.findData()}}},C=$,z=(a("5f63"),Object(v["a"])(C,s,o,!1,null,"9d8fdbf6",null));e["default"]=z.exports},bc5d:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"custom-header"},[a("div",{staticClass:"custom-header-title"},[a("span",[a("h3",[t._v(t._s(t.showName))])]),t._v(" "),t._t("title")],2),t._v(" "),a("div",{staticClass:"custom-tools"},[t._t("tools")],2)])},o=[],i=(a("e67d"),{name:"CustomHeader",props:{showName:{type:String,default:""}}}),n=i,r=a("2877"),l=Object(r["a"])(n,s,o,!1,null,null,null),p=l.exports;e["a"]=p},c0c5:function(t,e,a){},cf4a:function(t,e,a){},e67d:function(t,e,a){}}]);