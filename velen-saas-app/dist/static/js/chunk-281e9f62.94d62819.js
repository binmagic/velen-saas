(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-281e9f62"],{"01e2":function(t,e,a){"use strict";var l=a("1972"),s=a.n(l);s.a},1972:function(t,e,a){},ad28:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("custom-header",{attrs:{"show-name":t.$route.meta.title}}),t._v(" "),a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("调度规则设置")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleDialog()}}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"more-card-body"},[a("el-table",{attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"平台",prop:"platform"}}),t._v(" "),a("el-table-column",{attrs:{label:"process",prop:"process"}}),t._v(" "),a("el-table-column",{attrs:{label:"业务名",prop:"businessName"}}),t._v(" "),a("el-table-column",{attrs:{label:"DSL",prop:"dsl"}}),t._v(" "),a("el-table-column",{attrs:{label:"配置","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return t._l(l.properties,(function(e,l){return a("span",[t._v(t._s(l)+" : "+t._s(e)+";")])}))}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(t){t.row;return[a("i",{staticClass:"el-icon-edit"})]}}])})],1)],1)]),t._v(" "),a("basic-create",{attrs:{dialogVisible:t.dialogVisible,title:t.title,type:t.type},on:{"update:dialogVisible":function(e){t.dialogVisible=e},"update:dialog-visible":function(e){t.dialogVisible=e},"close-dialog":t.handleClose,"on-create-dispatch":t.handleCreate}})],1)},s=[],o=a("bc5d"),i=a("b775");function r(){return Object(i["a"])({url:"/dispatch/platform",method:"get"})}function n(){return Object(i["a"])({url:"/dispatch/process",method:"get"})}function c(t){return Object(i["a"])({url:"/dispatch",method:"get",query:t})}function p(t){return Object(i["a"])({url:"/dispatch",method:"post",data:t})}var u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,"before-close":t.handleClose,center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n    "+t._s(t.title)+"\n  ")]),t._v(" "),a("div",{staticStyle:{"overflow-y":"auto","max-height":"400px"}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"平台"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.platform,callback:function(e){t.platform=e},expression:"platform"}},t._l(t.platforms,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"process"}},[a("el-select",{attrs:{"value-key":"key"},model:{value:t.process,callback:function(e){t.process=e},expression:"process"}},t._l(t.processes,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t}})})),1)],1),t._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"业务名"}},[a("el-input",{attrs:{placeholder:"业务名不可重复"},model:{value:t.formData.businessName,callback:function(e){t.$set(t.formData,"businessName",e)},expression:"formData.businessName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"DSL"}},[a("el-input",{attrs:{placeholder:"调度表达式"},model:{value:t.formData.dsl,callback:function(e){t.$set(t.formData,"dsl",e)},expression:"formData.dsl"}})],1)],1)],1),t._v(" "),a("el-form",{attrs:{"label-position":"top"}},t._l(t.formData.properties,(function(e,l){return a("el-form-item",{attrs:{label:0==l?"properties":""}},[a("el-row",[a("el-col",{staticStyle:{"margin-right":"20px"},attrs:{span:8}},[a("el-input",{attrs:{placeholder:"名字",size:"small"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"prop.name"}})],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{size:"small"},model:{value:e.prop,callback:function(a){t.$set(e,"prop",a)},expression:"prop.prop"}})],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:1}},[0==l?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{cursor:"pointer"},on:{click:t.addRow}}):t._e()])],1)],1)})),1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)])},d=[],m=(a("7f7f"),{name:"basic-create",props:{dialogVisible:{type:Boolean,required:!0},title:{type:String}},data:function(){return{platforms:[],processes:[],platform:{},process:{},formData:{businessName:"",dsl:"",properties:[{name:"",prop:""}]}}},created:function(){this.findPlatform(),this.findProcess()},methods:{findPlatform:function(){var t=this;r().then((function(e){t.platforms=e}))},findProcess:function(){var t=this;n().then((function(e){t.processes=e}))},handleClose:function(){this.platform={},this.process={},this.formData={businessName:"",dsl:"",properties:[{name:"",prop:""}]},this.$emit("close-dialog")},handleSubmit:function(){var t=this,e={};this.formData.properties.some((function(t){e[t.name]=t.prop}));var a={platform:this.platform.name,platformType:this.platform.key,process:this.process.name,processType:this.process.key,businessName:this.formData.businessName,dsl:this.formData.dsl,properties:e};p(a).then((function(e){console.log(e),t.$emit("on-create-dispatch"),t.$emit("close-dialog")}))},addRow:function(){this.formData.properties.push({name:"",prop:""})}}}),f=m,h=a("2877"),b=Object(h["a"])(f,u,d,!1,null,"45957e64",null),v=b.exports,_={name:"index",components:{CustomHeader:o["a"],BasicCreate:v},data:function(){return{formData:{},dialogVisible:!1,title:"",type:"",dialogData:null,total:0,query:{page:1,limit:10},tableData:[{platform:"1",process:"1",businessName:"1",dsl:"1",properties:{id:"appId",name:"name"}}]}},created:function(){this.findData()},methods:{findData:function(){var t=this;c(this.query).then((function(e){t.total=e.total,t.tableData=e.items}))},handleDialog:function(t){this.dialogVisible=!0,this.title="创建"},handleClose:function(){this.dialogVisible=!1},handleCreate:function(){this.dialogVisible=!1,this.findData()}}},y=_,g=(a("01e2"),Object(h["a"])(y,l,s,!1,null,"69d15987",null));e["default"]=g.exports},bc5d:function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"custom-header"},[a("div",{staticClass:"custom-header-title"},[a("span",[a("h3",[t._v(t._s(t.showName))])]),t._v(" "),t._t("title")],2),t._v(" "),a("div",{staticClass:"custom-tools"},[t._t("tools")],2)])},s=[],o=(a("e67d"),{name:"CustomHeader",props:{showName:{type:String,default:""}}}),i=o,r=a("2877"),n=Object(r["a"])(i,l,s,!1,null,null,null),c=n.exports;e["a"]=c},e67d:function(t,e,a){}}]);