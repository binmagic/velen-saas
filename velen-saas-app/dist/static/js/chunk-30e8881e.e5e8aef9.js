(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30e8881e"],{"0c0d":function(t,e,a){"use strict";var n=a("1dad"),i=a.n(n);i.a},"192d":function(t,e,a){},"1dad":function(t,e,a){},"2b74":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{ref:"tableMain",staticStyle:{width:"100%"},attrs:{data:t.insideTableData}},t._l(t.insideColumns,(function(t){return a("el-table-column",{attrs:{label:t.label,align:t.align,width:t.width}})})),1)],1)},i=[],s={name:"Table",props:{value:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},editable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},searchPlace:{type:String,default:"top"}},data:function(){return{insideColumns:[],insideTableData:[],searchKey:"",searchValue:"",default_column:{align:"center",width:"auto"}}},watch:{columns:function(t){this.handleColumns(t),this.setDefaultSearchKey()},value:function(){this.handleTableData()}},mounted:function(){this.handleColumns(this.columns),this.setDefaultSearchKey(),this.handleTableData()},methods:{supportEdit:function(t,e){},supportHandle:function(t){},handleColumns:function(t){var e=this;this.insideColumns=t.map((function(t,a){var n=Object.assign({},e.default_column,t);return n.editable&&(n=e.supportEdit(n,a)),"handle"===n.key&&(n=e.supportHandle(n)),n}))},setDefaultSearchKey:function(t){},handleTableData:function(){this.insideTableData=this.value.map((function(t,e){var a=t;return a.initRowIndex=e,a}))}}},r=s,o=a("2877"),l=Object(o["a"])(r,n,i,!1,null,null,null),c=l.exports;e["a"]=c},"67bd":function(t,e,a){"use strict";var n=a("192d"),i=a.n(n);i.a},"7d99":function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"f",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"g",(function(){return l})),a.d(e,"h",(function(){return c})),a.d(e,"d",(function(){return u})),a.d(e,"a",(function(){return d}));var n=a("b775");function i(t){return Object(n["a"])({url:"/metadata/event",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/metadata/event",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/metadata/event/prop",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/metadata/event/prop",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/metadata/event",method:"put",data:t})}function c(t){return Object(n["a"])({url:"/metadata/event/prop",method:"put",data:t})}function u(t){return Object(n["a"])({url:"/metadata/event/prop/".concat(t),method:"delete"})}function d(){return Object(n["a"])({url:"/metadata/all",method:"get"})}},bc5d:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"custom-header"},[a("div",{staticClass:"custom-header-title"},[a("span",[a("h3",[t._v(t._s(t.showName))])]),t._v(" "),t._t("title")],2),t._v(" "),a("div",{staticClass:"custom-tools"},[t._t("tools")],2)])},i=[],s=(a("e67d"),{name:"CustomHeader",props:{showName:{type:String,default:""}}}),r=s,o=a("2877"),l=Object(o["a"])(r,n,i,!1,null,null,null),c=l.exports;e["a"]=c},e67d:function(t,e,a){},ed63:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("custom-header",{attrs:{"show-name":t.$route.meta.title}},[a("div",{attrs:{slot:"tools"},slot:"tools"},[a("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-folder-add"},slot:"reference"}),t._v(" "),a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{attrs:{label:"书签名"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.formData.comment,callback:function(e){t.$set(t.formData,"comment",e)},expression:"formData.comment"}})],1),t._v(" "),a("el-form-item",[a("el-button",[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitData}},[t._v("确定")])],1)],1)],1)],1)]),t._v(" "),a("el-container",{staticClass:"main"},[a("el-header",{staticClass:"meta-event-header"},[a("div",{staticStyle:{height:"50px"}},[a("span",[t._v("元事件")]),t._v(" "),a("el-select",{on:{change:t.handleSelectEvent},model:{value:t.switchEvent,callback:function(e){t.switchEvent=e},expression:"switchEvent"}},t._l(t.meta_events,(function(t){return a("el-option",{key:t.id,attrs:{label:t.showName,value:t.id}})})),1)],1)]),t._v(" "),a("el-main",[a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("el-col",{attrs:{span:8}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.originQuery.dateRange,callback:function(e){t.$set(t.originQuery,"dateRange",e)},expression:"originQuery.dateRange"}})],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:8}},[a("h4",[t._v(t._s(t.getMetaEventName()))])]),t._v(" "),a("el-col",{attrs:{span:8}})],1),t._v(" "),a("custom-table",{attrs:{columns:t.columns,value:t.data}}),t._v(" "),a("custom-charts",{attrs:{chartName:t.chartName}})],1)],1)],1)},i=[],s=(a("db97"),a("7f7f"),a("2b74")),r=a("bc5d"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{width:t.width}},[a("div",{staticClass:"chart-header"},[a("el-date-picker",{attrs:{type:"datetimerange",size:"small","default-time":["00:00:00","23:59:00"],"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.dateChange},model:{value:t.datePicker,callback:function(e){t.datePicker=e},expression:"datePicker"}}),t._v(" "),a("p",{staticClass:"chart-span"},[t._v("\n      "+t._s(t.chartName)+"\n    ")]),t._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("el-button",{attrs:{size:"small"}},[t._v("\n        显示设置"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click","visible-arrow":"false"},on:{command:t.clickCheck}},[a("el-button",{attrs:{size:"small"}},[t._v("\n          "+t._s(t.magicType.name)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.chartsType,(function(e){return a("el-dropdown-item",{attrs:{command:e}},[t._v(t._s(e.name))])})),1)],1),t._v(" "),a("el-dropdown",{attrs:{trigger:"click","visible-arrow":"false"},on:{command:t.xAxisCheck}},[a("el-button",{attrs:{size:"small"}},[t._v("\n          "+t._s(t.dateCheck.name)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.inputUnit,(function(e){return a("el-dropdown-item",{attrs:{command:e}},[t._v(t._s(e.name))])})),1)],1)],1)],1),t._v(" "),a("div",{style:{width:t.width,height:t.height},attrs:{id:"custom-charts"}})])},l=[],c=(a("6b54"),{name:"custom-charts",props:{chartName:{required:!0,type:String},width:{type:String,default:"100%"},height:{type:String,default:"450px"},timeRange:{type:Array,default:function(){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=new Date(t.setDate(t.getDate()-1)),a=new Date(t.setHours(23));return[e,a]}},chartType:{type:Object,default:function(){return{name:"线图",value:"line"}}},dateType:{type:Object,default:function(){return{name:"按天",value:"day"}}},xAxis:{type:Array},data:{type:Array}},data:function(){return{datePicker:this.timeRange,chartsType:[{name:"线图",value:"line"},{name:"柱图",value:"bar"},{name:"饼图",value:"pie"},{name:"累积",value:"stack"}],magicType:this.chartType,inputUnit:[{name:"按分钟",value:"minute"},{name:"按小时",value:"hour"},{name:"按天",value:"day"},{name:"按周",value:"week"},{name:"按月",value:"month"}],dateCheck:this.dateType}},methods:{clickCheck:function(t){var e=!0;this.magicType=t,this.$emit("chart-type-change",this.magicType),"stack"===t.value||("pie"==t.value&&(e=!1),this.setCharts(t.value,e))},xAxisCheck:function(t){if(this.dateCheck=t,this.datePicker){if("minute"===this.dateCheck.value){var e=new Date(this.datePicker[0]),a=new Date(this.datePicker[1]);e=new Date(a.getTime()-864e5+6e4),this.datePicker=[e.toString(),a.toString()],this.$message("按分钟查看，时间范围一次最多展示 1 天")}this.$emit("dateChange",{datePicker:this.datePicker,dateType:this.dateCheck})}},dateChange:function(){this.datePicker&&this.$emit("dateChange",{datePicker:this.datePicker,dateType:this.dateCheck})},setCharts:function(t,e){var a=this.$echarts.init(document.getElementById("custom-charts")),n={grid:{bottom:100},tooltip:{show:e,trigger:"axis"},legend:{show:!0,bottom:50,data:["日报表"]},toolbox:{show:!0,dataView:{show:!0}},xAxis:{show:e,type:"category",boundaryGap:!0,data:["2017-11-1","2017-11-2","2017-11-3","2017-11-4","2017-11-5","2017-11-6","2017-11-7","2017-11-8","2017-11-9","2017-11-10"]},yAxis:{show:e,type:"value"},dataZoom:[{type:"slider",show:!1,xAxisIndex:[0],start:0,end:100}],series:[{name:"日报表",type:t,data:[2,1,2,1,3,1,2,5,4,5],radius:"pie"===t?["40%","65%"]:null,center:"pie"===t?["50%","45%"]:null,label:{normal:{show:!e,position:"outside",textStyle:{fontWeight:300,fontSize:16},formatter:"{d}%"}}}]};a.setOption(n)}},mounted:function(){this.setCharts(this.magicType.value,"pie"!==this.magicType.value)}}),u=c,d=(a("67bd"),a("2877")),m=Object(d["a"])(u,o,l,!1,null,"4bbfab7c",null),h=m.exports,p=h,f=a("b775");function v(t){return Object(f["a"])({url:"/query/meta-event",method:"post",data:t})}var b=a("7d99"),g=a("75fb"),y={components:{CustomTable:s["a"],CustomHeader:r["a"],CustomCharts:p},data:function(){return{id:"",columns:[],data:[],switchEvent:"",meta_events:[],meta_props:{},query:{},originQuery:{dateRange:[]},formData:{name:"",comment:""},saveData:{data:"",name:"",config:"",type:"/meta_event_analytics/"},chartName:"测试"}},created:function(){this.fetchMetaEventProps(),this.fetchMetaEvent()},methods:{submitData:function(){var t=this;console.log("xxxxxsubmitdata"),this.saveData.name=this.formData.name,this.saveData.config=JSON.stringify({comment:this.comment}),this.saveData.data=JSON.stringify({measures:this.switchEvent,filter:{},chartsType:"pie",rangeText:"",from_date:"2020-06-08",to_date:"2020-06-09"}),Object(g["b"])(this.saveData).then((function(e){t.id=e.id}))},fetchData:function(){var t=this;v(this.query).then((function(e){t.data=e.items}))},fetchMetaEventProps:function(){var t=this;Object(b["f"])().then((function(e){for(var a in e.items)t.meta_props[e.items[a].id]=e.items[a]}))},fetchMetaEvent:function(){var t=this;Object(b["e"])().then((function(e){t.meta_events=e.items}))},handleSelectEvent:function(){var t=[];for(var e in this.meta_events){var a=this.meta_events[e];if(Object.is(a.id,this.switchEvent)){t=a.propIds;break}}this.handleColumn(t),this.fetchData()},handleColumn:function(t){for(var e in console.log(t),t){var a=this.meta_props[t[e]];this.columns.push({prop:a.name,label:a.showName})}},getMetaEventName:function(){for(var t in this.meta_events){var e=this.meta_events[t];if(Object.is(e.id,this.switchEvent))return e.showName}}}},_=y,w=(a("0c0d"),Object(d["a"])(_,n,i,!1,null,null,null));e["default"]=w.exports}}]);